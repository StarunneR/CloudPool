<script>
  function getYiju() {
    fetch("https://v1.hitokoto.cn")
      .then((response) => response.json())
      .then((data) => {
        const hitokoto = document.getElementById("hitokoto_text");
        hitokoto.href = "https://hitokoto.cn/?uuid=" + data.uuid;
        hitokoto.innerText = data.hitokoto;
        const from = document.getElementById("hitokoto_from");
        from.innerText = data.from;
        if (data.from_who != data.from) {
          const author = document.getElementById("hitokoto_author");
          author.innerText = data.from_who;
        } else {
          const author = document.getElementById("hitokoto_author");
          author.innerText = [];
        }
      })
      .catch(console.error);
  }
  getYiju();
</script>

<script type="text/javascript">
  function copyYiju() {
    // Create a new textarea element as cache for copying
    let text = document.getElementById("hitokoto").innerText
    const cache_area = document.createElement('textarea');
    document.body.appendChild(cache_area);
    cache_area.innerHTML = text;
    //cache_area.setAttribute('create',1);
    cache_area.select();
    document.execCommand("copyYiju");
    document.body.removeChild(cache_area);

    let input_box = document.getElementById("wl-edit");
    // console.log(input_box);
    if (input_box.value == "") {
      input_box.value = text;
      // dispatch input event to make upload button ready
      let evt = document.createEvent('HTMLEvents')
      evt.initEvent('input', true, true)
      input_box.dispatchEvent(evt)
    } else {
      input_box.select();
    }
  }
</script>
