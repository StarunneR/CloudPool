<div id="article-banner">
  <h2 class="post-title"><%- page.title %></h2>
  <% if (page.subtitle) { %>
    <h3 class="post-subtitle"><%- page.subtitle %></h3>
  <% } %>
  <% if (!page.nodate) { %> 
    <p class="post-date"><%- date(page.date, "YYYY-MM-DD") %></p>
  <% } %>
  <div class="arrow-down">
    <a href="javascript:;"></a>
  </div>
</div>

<% if (page.catalog == true) { %>
  <%- partial('_post/catalog') %>
<% } %>
<main class="app-body flex-box">
  <article class="post-article">
    <% if (page.content) { %>
      <%- partial('_post/front') %>
      <section class="markdown-content" id="content">
        <%- page.content %>
      </section>
      <% if (page.tags && page.tags.length) { %>
        <%- partial('_partial/tag', { tags: page.tags }) %>
      <% } %> 
    <% } %>
    <%- partial('_post/nav') %>
    <% if (theme.post.ad == true && page.ad != false && page.content) { %>
      <div class="advertisement">
        <p> 广告：快速学习 Crash Course十分钟速成课 <a href="https://crashcourse.club/">字幕组网站</a></p>
      </div>
    <% } %>
    <% if (theme.post.comment == true && page.comment != false) { %>
      <%- partial('_plugin/waline') %>
    <% } %>
    <% if (theme.post.reward == true && page.reward == true && page.content) { %>
      <%- partial('_post/reward') %>
    <% } %>
    <% if (theme.post.comment == true && page.qrcode != false && page.content) { %>
      <%- partial('_post/qrcode') %>
    <% } %>
  </article>
</main>

<script>
  // error image
  $(".markdown-content img").on("error", function () {
    $(this).attr("src", "/images/error.png");
    $(this).css({cursor: "default",});
  });

  // zoom image
  $(".markdown-content img").on('click', function() {
    var src = $(this).attr('src')
    if (src !== '/css/images/error.png') {
      var imageW = $(this).width()
      var imageH = $(this).height()

      var zoom = ($(window).width() * 0.95 / imageW).toFixed(2)
      zoom = zoom < 1 ? 1 : zoom
      zoom = zoom > 2 ? 2 : zoom
      var transY = (($(window).height() - imageH) / 2).toFixed(2)

      $('body').append('<div class="image-view-wrap"><div class="image-view-inner"><img src="'+ src +'" /></div></div>')
      $('.image-view-wrap').addClass('wrap-active')
      $('.image-view-wrap img').css({
        'width': `${imageW}`,
        'transform': `translate3d(0, ${transY}px, 0) scale3d(${zoom}, ${zoom}, 1)`
      })
      $('html').css('overflow', 'hidden')

      $('.image-view-wrap').on('click', function() {
        $(this).remove()
        $('html').attr('style', '')
      })
    }
  })
</script>

<script>
  (function () {
    var url = "<%= config.url %>/<%= page.path %>";
    var banner = "<%= page.banner %>";
    if (banner !== "" && banner !== "undefined" && banner !== "null") {
      $("#article-banner").css({
        "background-image": "url(" + banner + ")",
      });
    } else {
      $("#article-banner").geopattern(url);
    }
    $(".header").removeClass("fixed-header");
  })();
</script>
 